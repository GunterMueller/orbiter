%
% created by a2tex
%
\begin{tabbing}
55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= \kill
//\ sarnak\symbol{46}C\\[0pt]
//\\[0pt]
//\ Anton\ Betten\\[0pt]
//\ November\ 2\symbol{44}\ 2011\\[0pt]
//\\[0pt]
//\ creates\ the\ graphs\ described\ in\ the\ paper:\\[0pt]
//\\[0pt]
//\ @article\ \symbol{123}MR963118\symbol{44}\\[0pt]
//\ \ \ \ AUTHOR\ =\ \symbol{123}Lubotzky\symbol{44}\ A\symbol{46}\ and\ Phillips\symbol{44}\ R\symbol{46}\ and\ Sarnak\symbol{44}\ P\symbol{46}\symbol{125}\symbol{44}\\[0pt]
//\ \ \ \ \ TITLE\ =\ \symbol{123}Ramanujan\ graphs\symbol{125}\symbol{44}\\[0pt]
//\ \ \ JOURNAL\ =\ \symbol{123}Combinatorica\symbol{125}\symbol{44}\\[0pt]
//\ \ FJOURNAL\ =\ \symbol{123}Combinatorica\symbol{46}\ An\ International\ Journal\ of\ the\ J\symbol{92}\symbol{19}anos\ Bolyai\\[0pt]
//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Mathematical\ Society\symbol{125}\symbol{44}\\[0pt]
//\ \ \ \ VOLUME\ =\ \symbol{123}8\symbol{125}\symbol{44}\\[0pt]
//\ \ \ \ \ \ YEAR\ =\ \symbol{123}1988\symbol{125}\symbol{44}\\[0pt]
//\ \ \ \ NUMBER\ =\ \symbol{123}3\symbol{125}\symbol{44}\\[0pt]
//\ \ \ \ \ PAGES\ =\ \symbol{123}261\symbol{45}\symbol{45}277\symbol{125}\symbol{44}\\[0pt]
//\ \ \ \ \ \ ISSN\ =\ \symbol{123}0209\symbol{45}9683\symbol{125}\symbol{44}\\[0pt]
//\ \ \ \ \ CODEN\ =\ \symbol{123}COMBDI\symbol{125}\symbol{44}\\[0pt]
//\ \ \ MRCLASS\ =\ \symbol{123}05C75\ (05C25\ 05C50)\symbol{125}\symbol{44}\\[0pt]
//\ \ MRNUMBER\ =\ \symbol{123}963118\ (89m:05099)\symbol{125}\symbol{44}\\[0pt]
//MRREVIEWER\ =\ \symbol{123}Dave\ Witte\ Morris\symbol{125}\symbol{44}\\[0pt]
//\ \ \ \ \ \ \ DOI\ =\ \symbol{123}10\symbol{46}1007/BF02126799\symbol{125}\symbol{44}\\[0pt]
//\ \ \ \ \ \ \ URL\ =\ \symbol{123}http://0\symbol{45}dx\symbol{46}doi\symbol{46}org\symbol{46}catalog\symbol{46}library\symbol{46}colostate\symbol{46}edu/10\symbol{46}1007/BF02126799\symbol{125}\symbol{44}\\[0pt]
//\symbol{125}\\[0pt]
\\[0pt]
\symbol{35}include\ \symbol{34}orbiter\symbol{46}h\symbol{34}\\[0pt]
\\[0pt]
\\[0pt]
INT\ t0;\\[0pt]
\\[0pt]
void\ do\symbol{95}it(INT\ p\symbol{44}\ INT\ q\symbol{44}\ INT\ verbose\symbol{95}level);\\[0pt]
\\[0pt]
\\[0pt]
\\[0pt]
int\ main(int\ argc\symbol{44}\ char\ **argv)\\[0pt]
\symbol{123}\\[0pt]
\>INT\ i;\\[0pt]
\>INT\ verbose\symbol{95}level\ =\ 0;\\[0pt]
\>INT\ f\symbol{95}p\ =\ FALSE;\\[0pt]
\>INT\ p\ =\ 0;\\[0pt]
\>INT\ f\symbol{95}q\ =\ FALSE;\\[0pt]
\>INT\ q\ =\ 0;\\[0pt]
\\[0pt]
\>t0\ =\ os\symbol{95}ticks();\\[0pt]
\\[0pt]
\>\\[0pt]
\>for\ (i\ =\ 1;\ i\ <\ argc;\ i++)\ \symbol{123}\\[0pt]
\>\>if\ (strcmp(argv[i]\symbol{44}\ \symbol{34}\symbol{45}v\symbol{34})\ ==\ 0)\ \symbol{123}\\[0pt]
\>\>\>verbose\symbol{95}level\ =\ atoi(argv[++i]);\\[0pt]
\>\>\>cout\ <<\ \symbol{34}\symbol{45}v\ \symbol{34}\ <<\ verbose\symbol{95}level\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>else\ if\ (strcmp(argv[i]\symbol{44}\ \symbol{34}\symbol{45}p\symbol{34})\ ==\ 0)\ \symbol{123}\\[0pt]
\>\>\>f\symbol{95}p\ =\ TRUE;\\[0pt]
\>\>\>p\ =\ atoi(argv[++i]);\\[0pt]
\>\>\>cout\ <<\ \symbol{34}\symbol{45}p\ \symbol{34}\ <<\ p\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>else\ if\ (strcmp(argv[i]\symbol{44}\ \symbol{34}\symbol{45}q\symbol{34})\ ==\ 0)\ \symbol{123}\\[0pt]
\>\>\>f\symbol{95}q\ =\ TRUE;\\[0pt]
\>\>\>q\ =\ atoi(argv[++i]);\\[0pt]
\>\>\>cout\ <<\ \symbol{34}\symbol{45}q\ \symbol{34}\ <<\ q\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>\symbol{125}\\[0pt]
\>\\[0pt]
\\[0pt]
\\[0pt]
\>if\ (\symbol{33}f\symbol{95}p)\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}please\ specify\ \symbol{45}p\ <p>\symbol{34}\ <<\ endl;\\[0pt]
\>\>exit(1);\\[0pt]
\>\>\symbol{125}\\[0pt]
\>if\ (\symbol{33}f\symbol{95}q)\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}please\ specify\ \symbol{45}q\ <q>\symbol{34}\ <<\ endl;\\[0pt]
\>\>exit(1);\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\>do\symbol{95}it(p\symbol{44}\ q\symbol{44}\ verbose\symbol{95}level);\\[0pt]
\>\\[0pt]
\symbol{125}\\[0pt]
\\[0pt]
void\ do\symbol{95}it(INT\ p\symbol{44}\ INT\ q\symbol{44}\ INT\ verbose\symbol{95}level)\\[0pt]
\symbol{123}\\[0pt]
\>INT\ f\symbol{95}v\ =\ (verbose\symbol{95}level\ >=\ 1);\\[0pt]
\>INT\ f\symbol{95}vv\ =\ (verbose\symbol{95}level\ >=\ 2);\\[0pt]
\>INT\ i\symbol{44}\ j\symbol{44}\ h\symbol{44}\ l\symbol{44}\ f\symbol{95}special\ =\ FALSE;\\[0pt]
\\[0pt]
\\[0pt]
\\[0pt]
\>l\ =\ Legendre(p\symbol{44}\ q\symbol{44}\ 0);\\[0pt]
\>cout\ <<\ \symbol{34}Legendre(\symbol{34}\ <<\ p\ <<\ \symbol{34}\symbol{44}\ \symbol{34}\ <<\ q\ <<\ \symbol{34})=\symbol{34}\ <<\ l\ <<\ endl;\\[0pt]
\\[0pt]
\\[0pt]
\>finite\symbol{95}field\ *F;\\[0pt]
\>action\ *A;\\[0pt]
\>INT\ f\symbol{95}semilinear\ =\ FALSE;\\[0pt]
\>INT\ f\symbol{95}basis\ =\ TRUE;\\[0pt]
\\[0pt]
\>F\ =\ new\ finite\symbol{95}field;\\[0pt]
\>F\symbol{45}>init(q\symbol{44}\ 0);\\[0pt]
\>//F\symbol{45}>init\symbol{95}override\symbol{95}polynomial(q\symbol{44}\ override\symbol{95}poly\symbol{44}\ verbose\symbol{95}level);\\[0pt]
\\[0pt]
\>A\ =\ new\ action;\\[0pt]
\>\\[0pt]
\>if\ (l\ ==\ 1)\ \symbol{123}\\[0pt]
\>\>f\symbol{95}special\ =\ TRUE;\\[0pt]
\\[0pt]
\>\>cout\ <<\ \symbol{34}Creating\ projective\ special\ linear\ group:\symbol{34}\ <<\ endl;\ \\[0pt]
\>\>A\symbol{45}>init\symbol{95}projective\symbol{95}special\symbol{95}group(2\symbol{44}\ F\symbol{44}\ \\[0pt]
\>\>\>f\symbol{95}semilinear\symbol{44}\ \\[0pt]
\>\>\>f\symbol{95}basis\symbol{44}\ \\[0pt]
\>\>\>verbose\symbol{95}level\ \symbol{45}\ 2);\>\>\\[0pt]
\>\>\symbol{125}\\[0pt]
\>else\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}Creating\ projective\ linear\ group:\symbol{34}\ <<\ endl;\ \\[0pt]
\>\>A\symbol{45}>init\symbol{95}projective\symbol{95}group(2\symbol{44}\ F\symbol{44}\ \\[0pt]
\>\>\>f\symbol{95}semilinear\symbol{44}\ \\[0pt]
\>\>\>f\symbol{95}basis\symbol{44}\ \\[0pt]
\>\>\>verbose\symbol{95}level\ \symbol{45}\ 2);\>\>\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\\[0pt]
\\[0pt]
\>sims\ *Sims;\\[0pt]
\\[0pt]
\>Sims\ =\ A\symbol{45}>Sims;\>\\[0pt]
\\[0pt]
\>\\[0pt]
\>longinteger\symbol{95}object\ go;\\[0pt]
\>INT\ goi;\\[0pt]
\>Sims\symbol{45}>group\symbol{95}order(go);\\[0pt]
\\[0pt]
\>cout\ <<\ \symbol{34}found\ a\ group\ of\ order\ \symbol{34}\ <<\ go\ <<\ endl;\\[0pt]
\>goi\ =\ go\symbol{46}as\symbol{95}INT();\\[0pt]
\>cout\ <<\ \symbol{34}found\ a\ group\ of\ order\ \symbol{34}\ <<\ goi\ <<\ endl;\\[0pt]
\\[0pt]
\>\\[0pt]
\\[0pt]
\\[0pt]
\>INT\ a0\symbol{44}\ a1\symbol{44}\ a2\symbol{44}\ a3;\\[0pt]
\>INT\ sqrt\symbol{95}p;\\[0pt]
\\[0pt]
\>INT\ *sqrt\symbol{95}mod\symbol{95}q;\\[0pt]
\>INT\ I;\\[0pt]
\>INT\ *A4;\\[0pt]
\>INT\ nb\symbol{95}A4\ =\ 0;\\[0pt]
\\[0pt]
\>A4\ =\ NEW\symbol{95}INT((p\ +\ 1)\ *\ 4);\\[0pt]
\>sqrt\symbol{95}mod\symbol{95}q\ =\ NEW\symbol{95}INT(q);\\[0pt]
\>for\ (i\ =\ 0;\ i\ <\ q;\ i++)\ \symbol{123}\\[0pt]
\>\>sqrt\symbol{95}mod\symbol{95}q[i]\ =\ \symbol{45}1;\\[0pt]
\>\>\symbol{125}\\[0pt]
\>for\ (i\ =\ 0;\ i\ <\ q;\ i++)\ \symbol{123}\\[0pt]
\>\>j\ =\ F\symbol{45}>mult(i\symbol{44}\ i);\\[0pt]
\>\>sqrt\symbol{95}mod\symbol{95}q[j]\ =\ i;\\[0pt]
\>\>\symbol{125}\\[0pt]
\>cout\ <<\ \symbol{34}sqrt\symbol{95}mod\symbol{95}q:\symbol{34}\ <<\ endl;\\[0pt]
\>INT\symbol{95}vec\symbol{95}print(cout\symbol{44}\ sqrt\symbol{95}mod\symbol{95}q\symbol{44}\ q);\\[0pt]
\>cout\ <<\ endl;\\[0pt]
\\[0pt]
\>sqrt\symbol{95}p\ =\ 0;\\[0pt]
\>for\ (i\ =\ 1;\ i\ <\ p;\ i++)\ \symbol{123}\\[0pt]
\>\>if\ (i\ *\ i\ >\ p)\ \symbol{123}\\[0pt]
\>\>\>sqrt\symbol{95}p\ =\ i\ \symbol{45}\ 1;\\[0pt]
\>\>\>break;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>\symbol{125}\\[0pt]
\>cout\ <<\ \symbol{34}p=\symbol{34}\ <<\ p\ <<\ endl;\\[0pt]
\>cout\ <<\ \symbol{34}sqrt\symbol{95}p\ =\ \symbol{34}\ <<\ sqrt\symbol{95}p\ <<\ endl;\\[0pt]
\\[0pt]
\>\\[0pt]
\>for\ (I\ =\ 0;\ I\ <\ q;\ I++)\ \symbol{123}\\[0pt]
\>\>if\ (F\symbol{45}>add(F\symbol{45}>mult(I\symbol{44}\ I)\symbol{44}\ 1)\ ==\ 0)\ \symbol{123}\\[0pt]
\>\>\>break;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>\symbol{125}\\[0pt]
\>if\ (I\ ==\ q)\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}did\ not\ find\ I\symbol{34}\ <<\ endl;\\[0pt]
\>\>exit(1);\\[0pt]
\>\>\symbol{125}\\[0pt]
\>cout\ <<\ \symbol{34}I=\symbol{34}\ <<\ I\ <<\ endl;\\[0pt]
\>\\[0pt]
\>for\ (a0\ =\ 1;\ a0\ <=\ sqrt\symbol{95}p;\ a0++)\ \symbol{123}\\[0pt]
\>\>if\ (EVEN(a0))\ \symbol{123}\\[0pt]
\>\>\>continue;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>for\ (a1\ =\ \symbol{45}sqrt\symbol{95}p;\ a1\ <=\ sqrt\symbol{95}p;\ a1++)\ \symbol{123}\\[0pt]
\>\>\>if\ (ODD(a1))\ \symbol{123}\\[0pt]
\>\>\>\>continue;\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>for\ (a2\ =\ \symbol{45}sqrt\symbol{95}p;\ a2\ <=\ sqrt\symbol{95}p;\ a2++)\ \symbol{123}\\[0pt]
\>\>\>\>if\ (ODD(a2))\ \symbol{123}\\[0pt]
\>\>\>\>\>continue;\\[0pt]
\>\>\>\>\>\symbol{125}\\[0pt]
\>\>\>\>for\ (a3\ =\ \symbol{45}sqrt\symbol{95}p;\ a3\ <=\ sqrt\symbol{95}p;\ a3++)\ \symbol{123}\\[0pt]
\>\>\>\>\>if\ (ODD(a3))\ \symbol{123}\\[0pt]
\>\>\>\>\>\>continue;\\[0pt]
\>\>\>\>\>\>\symbol{125}\\[0pt]
\>\>\>\>\>if\ (a0\ *\ a0\ +\ a1\ *\ a1\ +\ a2\ *\ a2\ +\ a3\ *\ a3\ ==\ p)\ \symbol{123}\\[0pt]
\>\>\>\>\>\>cout\ <<\ \symbol{34}solution\ \symbol{34}\ <<\ nb\symbol{95}A4\ <<\ \symbol{34}\ :\ \symbol{34}\ <<\ a0\ <<\ \symbol{34}\symbol{44}\ \symbol{34}\ <<\ a1\ <<\ \symbol{34}\symbol{44}\ \symbol{34}\ <<\ a2\ <<\ \symbol{34}\symbol{44}\ \symbol{34}\ <<\ a3\ <<\ \symbol{34}\symbol{44}\ \symbol{34}\ <<\ endl;\\[0pt]
\>\>\>\>\>\>if\ (nb\symbol{95}A4\ ==\ p\ +\ 1)\ \symbol{123}\ \\[0pt]
\>\>\>\>\>\>\>cout\ <<\ \symbol{34}too\ many\ solutions\symbol{34}\ <<\ endl;\\[0pt]
\>\>\>\>\>\>\>exit(1);\\[0pt]
\>\>\>\>\>\>\>\symbol{125}\\[0pt]
\>\>\>\>\>\>A4[nb\symbol{95}A4\ *\ 4\ +\ 0]\ =\ a0;\\[0pt]
\>\>\>\>\>\>A4[nb\symbol{95}A4\ *\ 4\ +\ 1]\ =\ a1;\\[0pt]
\>\>\>\>\>\>A4[nb\symbol{95}A4\ *\ 4\ +\ 2]\ =\ a2;\\[0pt]
\>\>\>\>\>\>A4[nb\symbol{95}A4\ *\ 4\ +\ 3]\ =\ a3;\\[0pt]
\>\>\>\>\>\>nb\symbol{95}A4++;\\[0pt]
\>\>\>\>\>\>\symbol{125}\\[0pt]
\>\>\>\>\>\symbol{125}\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>\symbol{125}\ \\[0pt]
\\[0pt]
\>cout\ <<\ \symbol{34}nb\symbol{95}A4=\symbol{34}\ <<\ nb\symbol{95}A4\ <<\ endl;\\[0pt]
\>if\ (nb\symbol{95}A4\ \symbol{33}=\ p\ +\ 1)\ \symbol{123}\ \\[0pt]
\>\>cout\ <<\ \symbol{34}nb\symbol{95}A4\ \symbol{33}=\ p\ +\ 1\symbol{34}\ <<\ endl;\\[0pt]
\>\>exit(1);\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\>INT\symbol{95}matrix\symbol{95}print(A4\symbol{44}\ nb\symbol{95}A4\symbol{44}\ 4);\\[0pt]
\\[0pt]
\>vector\symbol{95}ge\ *gens;\\[0pt]
\>INT\ *Elt1;\\[0pt]
\>INT\ *Elt2;\\[0pt]
\>INT\ *Elt3;\\[0pt]
\>INT\ M4[4];\\[0pt]
\>INT\ det\symbol{44}\ s\symbol{44}\ sv;\\[0pt]
\>\\[0pt]
\>Elt1\ =\ NEW\symbol{95}INT(A\symbol{45}>elt\symbol{95}size\symbol{95}in\symbol{95}INT);\\[0pt]
\>Elt2\ =\ NEW\symbol{95}INT(A\symbol{45}>elt\symbol{95}size\symbol{95}in\symbol{95}INT);\\[0pt]
\>Elt3\ =\ NEW\symbol{95}INT(A\symbol{45}>elt\symbol{95}size\symbol{95}in\symbol{95}INT);\\[0pt]
\\[0pt]
\>gens\ =\ new\ vector\symbol{95}ge;\\[0pt]
\>gens\symbol{45}>init(A);\\[0pt]
\>gens\symbol{45}>allocate(nb\symbol{95}A4);\\[0pt]
\>\\[0pt]
\>cout\ <<\ \symbol{34}making\ connection\ set:\symbol{34}\ <<\ endl;\\[0pt]
\>for\ (i\ =\ 0;\ i\ <\ nb\symbol{95}A4;\ i++)\ \symbol{123}\\[0pt]
\\[0pt]
\>\>if\ (f\symbol{95}vv)\ \symbol{123}\\[0pt]
\>\>\>cout\ <<\ \symbol{34}making\ generator\ \symbol{34}\ <<\ i\ <<\ \symbol{34}:\symbol{34}\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>a0\ =\ A4[i\ *\ 4\ +\ 0]\ \symbol{37}\ q;\\[0pt]
\>\>a1\ =\ A4[i\ *\ 4\ +\ 1]\ \symbol{37}\ q;\\[0pt]
\>\>a2\ =\ A4[i\ *\ 4\ +\ 2]\ \symbol{37}\ q;\\[0pt]
\>\>a3\ =\ A4[i\ *\ 4\ +\ 3]\ \symbol{37}\ q;\\[0pt]
\>\>if\ (a0\ <\ 0)\ \symbol{123}\\[0pt]
\>\>\>a0\ +=\ q;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>if\ (a1\ <\ 0)\ \symbol{123}\\[0pt]
\>\>\>a1\ +=\ q;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>if\ (a2\ <\ 0)\ \symbol{123}\\[0pt]
\>\>\>a2\ +=\ q;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>if\ (a3\ <\ 0)\ \symbol{123}\\[0pt]
\>\>\>a3\ +=\ q;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>M4[0]\ =\ F\symbol{45}>add(a0\symbol{44}\ F\symbol{45}>mult(I\symbol{44}\ a1));\\[0pt]
\>\>M4[1]\ =\ F\symbol{45}>add(a2\symbol{44}\ F\symbol{45}>mult(I\symbol{44}\ a3));\\[0pt]
\>\>M4[2]\ =\ F\symbol{45}>add(F\symbol{45}>negate(a2)\symbol{44}\ F\symbol{45}>mult(I\symbol{44}\ a3));\\[0pt]
\>\>M4[3]\ =\ F\symbol{45}>add(a0\symbol{44}\ F\symbol{45}>negate(F\symbol{45}>mult(I\symbol{44}\ a1)));\\[0pt]
\\[0pt]
\>\>if\ (f\symbol{95}vv)\ \symbol{123}\\[0pt]
\>\>\>cout\ <<\ \symbol{34}M4=\symbol{34};\\[0pt]
\>\>\>INT\symbol{95}vec\symbol{95}print(cout\symbol{44}\ M4\symbol{44}\ 4);\\[0pt]
\>\>\>cout\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\\[0pt]
\>\>if\ (f\symbol{95}special)\ \symbol{123}\\[0pt]
\>\>\>det\ =\ F\symbol{45}>add(F\symbol{45}>mult(M4[0]\symbol{44}\ M4[3])\symbol{44}\ F\symbol{45}>negate(F\symbol{45}>mult(M4[1]\symbol{44}\ M4[2])));\\[0pt]
\\[0pt]
\>\>\>if\ (f\symbol{95}vv)\ \symbol{123}\\[0pt]
\>\>\>\>cout\ <<\ \symbol{34}det=\symbol{34}\ <<\ det\ <<\ endl;\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\\[0pt]
\>\>\>s\ =\ sqrt\symbol{95}mod\symbol{95}q[det];\\[0pt]
\>\>\>if\ (s\ ==\ \symbol{45}1)\ \symbol{123}\\[0pt]
\>\>\>\>cout\ <<\ \symbol{34}determinant\ is\ not\ a\ square\symbol{34}\ <<\ endl;\\[0pt]
\>\>\>\>exit(1);\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>sv\ =\ F\symbol{45}>inverse(s);\\[0pt]
\>\>\>for\ (j\ =\ 0;\ j\ <\ 4;\ j++)\ \symbol{123}\\[0pt]
\>\>\>\>M4[j]\ =\ F\symbol{45}>mult(sv\symbol{44}\ M4[j]);\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>if\ (f\symbol{95}vv)\ \symbol{123}\\[0pt]
\>\>\>\>cout\ <<\ \symbol{34}M4=\symbol{34};\\[0pt]
\>\>\>\>INT\symbol{95}vec\symbol{95}print(cout\symbol{44}\ M4\symbol{44}\ 4);\\[0pt]
\>\>\>\>cout\ <<\ endl;\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\\[0pt]
\>\>A\symbol{45}>make\symbol{95}element(Elt1\symbol{44}\ M4\symbol{44}\ verbose\symbol{95}level\ \symbol{45}\ 1);\\[0pt]
\\[0pt]
\>\>if\ (f\symbol{95}v)\ \symbol{123}\\[0pt]
\>\>\>cout\ <<\ \symbol{34}s\symbol{95}\symbol{34}\ <<\ i\ <<\ \symbol{34}=\symbol{34}\ <<\ endl;\\[0pt]
\>\>\>A\symbol{45}>element\symbol{95}print\symbol{95}quick(Elt1\symbol{44}\ cout);\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\\[0pt]
\>\>A\symbol{45}>element\symbol{95}move(Elt1\symbol{44}\ gens\symbol{45}>ith(i)\symbol{44}\ 0);\\[0pt]
\>\>\symbol{125}\\[0pt]
\>\\[0pt]
\\[0pt]
\>INT\ *Adj;\\[0pt]
\\[0pt]
\>Adj\ =\ NEW\symbol{95}INT(goi\ *\ goi);\\[0pt]
\\[0pt]
\>INT\symbol{95}vec\symbol{95}zero(Adj\symbol{44}\ goi\ *\ goi);\\[0pt]
\\[0pt]
\>cout\ <<\ \symbol{34}Computing\ the\ Cayley\ graph:\symbol{34}\ <<\ endl;\\[0pt]
\>for\ (i\ =\ 0;\ i\ <\ goi;\ i++)\ \symbol{123}\\[0pt]
\>\>Sims\symbol{45}>element\symbol{95}unrank\symbol{95}INT(i\symbol{44}\ Elt1);\\[0pt]
\>\>for\ (h\ =\ 0;\ h\ <\ nb\symbol{95}A4;\ h++)\ \symbol{123}\\[0pt]
\>\>\>A\symbol{45}>element\symbol{95}mult(Elt1\symbol{44}\ gens\symbol{45}>ith(h)\symbol{44}\ Elt2\symbol{44}\ 0);\\[0pt]
\symbol{35}if\ 0\\[0pt]
\>\>\>cout\ <<\ \symbol{34}i=\symbol{34}\ <<\ i\ <<\ \symbol{34}\ h=\symbol{34}\ <<\ h\ <<\ endl;\\[0pt]
\>\>\>cout\ <<\ \symbol{34}Elt1=\symbol{34}\ <<\ endl;\\[0pt]
\>\>\>A\symbol{45}>element\symbol{95}print\symbol{95}quick(Elt1\symbol{44}\ cout);\\[0pt]
\>\>\>cout\ <<\ \symbol{34}g\symbol{95}h=\symbol{34}\ <<\ endl;\\[0pt]
\>\>\>A\symbol{45}>element\symbol{95}print\symbol{95}quick(gens\symbol{45}>ith(h)\symbol{44}\ cout);\\[0pt]
\>\>\>cout\ <<\ \symbol{34}Elt2=\symbol{34}\ <<\ endl;\\[0pt]
\>\>\>A\symbol{45}>element\symbol{95}print\symbol{95}quick(Elt2\symbol{44}\ cout);\\[0pt]
\symbol{35}endif\\[0pt]
\>\>\>j\ =\ Sims\symbol{45}>element\symbol{95}rank\symbol{95}INT(Elt2);\\[0pt]
\>\>\>Adj[i\ *\ goi\ +\ j]\ =\ Adj[j\ *\ goi\ +\ i]\ =\ 1;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\>cout\ <<\ \symbol{34}The\ adjacency\ matrix\ of\ a\ graph\ with\ \symbol{34}\ <<\ goi\ <<\ \symbol{34}\ vertices\ has\ been\ computed\symbol{34}\ <<\ endl;\\[0pt]
\>//INT\symbol{95}matrix\symbol{95}print(Adj\symbol{44}\ goi\symbol{44}\ goi);\\[0pt]
\\[0pt]
\\[0pt]
\\[0pt]
\>colored\symbol{95}graph\ *CG;\\[0pt]
\>BYTE\ fname[1000];\\[0pt]
\\[0pt]
\>CG\ =\ new\ colored\symbol{95}graph;\\[0pt]
\>CG\symbol{45}>init\symbol{95}adjacency\symbol{95}no\symbol{95}colors(goi\symbol{44}\ Adj\symbol{44}\ verbose\symbol{95}level);\\[0pt]
\\[0pt]
\>sprintf(fname\symbol{44}\ \symbol{34}Sarnak\symbol{95}\symbol{37}ld\symbol{95}\symbol{37}ld\symbol{46}colored\symbol{95}graph\symbol{34}\symbol{44}\ p\symbol{44}\ q);\\[0pt]
\\[0pt]
\>CG\symbol{45}>save(fname\symbol{44}\ verbose\symbol{95}level);\\[0pt]
\\[0pt]
\\[0pt]
\>delete\ CG;\\[0pt]
\>delete\ gens;\\[0pt]
\>delete\ A;\\[0pt]
\>FREE\symbol{95}INT(A4);\\[0pt]
\>FREE\symbol{95}INT(Elt1);\\[0pt]
\>FREE\symbol{95}INT(Elt2);\\[0pt]
\>FREE\symbol{95}INT(Elt3);\\[0pt]
\>delete\ F;\\[0pt]
\\[0pt]
\symbol{125}\\[0pt]
\\[0pt]
\\[0pt]
\end{tabbing}
