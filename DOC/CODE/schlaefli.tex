%
% created by a2tex
%
\begin{tabbing}
55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= \kill
//\ schlaefli\symbol{46}C\\[0pt]
//\ \\[0pt]
//\ Anton\ Betten\\[0pt]
//\ January\ 21\symbol{44}\ 2015\\[0pt]
\\[0pt]
\symbol{35}include\ \symbol{34}orbiter\symbol{46}h\symbol{34}\\[0pt]
\\[0pt]
\\[0pt]
INT\ evaluate\symbol{95}cubic\symbol{95}form(finite\symbol{95}field\ *F\symbol{44}\ INT\ *v);\\[0pt]
\\[0pt]
int\ main(int\ argc\symbol{44}\ char\ **argv)\\[0pt]
\symbol{123}\\[0pt]
\>INT\ verbose\symbol{95}level\ =\ 0;\\[0pt]
\>INT\ i\symbol{44}\ j\symbol{44}\ rr\symbol{44}\ sz\symbol{44}\ N;\\[0pt]
\>finite\symbol{95}field\ *F;\\[0pt]
\>grassmann\ *Gr;\\[0pt]
\>INT\ *Adj;\\[0pt]
\>INT\ *M1;\\[0pt]
\>INT\ *M2;\\[0pt]
\>INT\ *M;\\[0pt]
\>INT\ v[2];\\[0pt]
\>INT\ w[4];\\[0pt]
\>INT\ *List;\\[0pt]
\>INT\ f\symbol{95}q\ =\ FALSE;\\[0pt]
\>INT\ q;\\[0pt]
\>INT\ n\ =\ 4;\\[0pt]
\>INT\ k\ =\ 2;\\[0pt]
\\[0pt]
\>for\ (i\ =\ 1;\ i\ <\ argc;\ i++)\ \symbol{123}\\[0pt]
\>\>if\ (strcmp(argv[i]\symbol{44}\ \symbol{34}\symbol{45}v\symbol{34})\ ==\ 0)\ \symbol{123}\\[0pt]
\>\>\>verbose\symbol{95}level\ =\ atoi(argv[++i]);\\[0pt]
\>\>\>cout\ <<\ \symbol{34}\symbol{45}v\ \symbol{34}\ <<\ verbose\symbol{95}level\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>else\ if\ (strcmp(argv[i]\symbol{44}\ \symbol{34}\symbol{45}q\symbol{34})\ ==\ 0)\ \symbol{123}\\[0pt]
\>\>\>f\symbol{95}q\ =\ TRUE;\\[0pt]
\>\>\>q\ =\ atoi(argv[++i]);\\[0pt]
\>\>\>cout\ <<\ \symbol{34}\symbol{45}q\ \symbol{34}\ <<\ q\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\>if\ (\symbol{33}f\symbol{95}q)\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}Please\ use\ option\ \symbol{45}q\ <q>\symbol{34}\ <<\ endl;\\[0pt]
\>\>exit(1);\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\>F\ =\ new\ finite\symbol{95}field;\\[0pt]
\>F\symbol{45}>init(q\symbol{44}\ verbose\symbol{95}level);\\[0pt]
\\[0pt]
\>Gr\ =\ new\ grassmann;\\[0pt]
\>Gr\symbol{45}>init(n\symbol{44}\ k\symbol{44}\ F\symbol{44}\ verbose\symbol{95}level);\\[0pt]
\\[0pt]
\>M1\ =\ NEW\symbol{95}INT(k\ *\ n);\\[0pt]
\>M2\ =\ NEW\symbol{95}INT(k\ *\ n);\\[0pt]
\>M\ =\ NEW\symbol{95}INT(2\ *\ k\ *\ n);\\[0pt]
\\[0pt]
\>N\ =\ generalized\symbol{95}binomial(n\symbol{44}\ k\symbol{44}\ q);\\[0pt]
\\[0pt]
\>List\ =\ NEW\symbol{95}INT(N);\\[0pt]
\>sz\ =\ 0;\\[0pt]
\\[0pt]
\>for\ (i\ =\ 0;\ i\ <\ N;\ i++)\ \symbol{123}\\[0pt]
\>\>Gr\symbol{45}>unrank\symbol{95}INT\symbol{95}here(M1\symbol{44}\ i\symbol{44}\ 0\ /*\ verbose\symbol{95}level\ */);\\[0pt]
\>\>\\[0pt]
\>\>for\ (j\ =\ 0;\ j\ <\ q\ +\ 1;\ j++)\ \symbol{123}\\[0pt]
\>\>\>F\symbol{45}>unrank\symbol{95}point\symbol{95}in\symbol{95}PG(v\symbol{44}\ 2\symbol{44}\ j);\\[0pt]
\>\>\>F\symbol{45}>mult\symbol{95}vector\symbol{95}from\symbol{95}the\symbol{95}left(v\symbol{44}\ M1\symbol{44}\ w\symbol{44}\ k\symbol{44}\ n);\\[0pt]
\>\>\>if\ (evaluate\symbol{95}cubic\symbol{95}form(F\symbol{44}\ w))\ \symbol{123}\\[0pt]
\>\>\>\>break;\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>if\ (j\ ==\ q\ +\ 1)\ \symbol{123}\\[0pt]
\>\>\>List[sz++]\ =\ i;\\[0pt]
\>\>\>\symbol{125}\ \\[0pt]
\>\>\symbol{125}\\[0pt]
\>cout\ <<\ \symbol{34}We\ found\ \symbol{34}\ <<\ sz\ <<\ \symbol{34}\ lines\symbol{34}\ <<\ endl;\\[0pt]
\>\\[0pt]
\\[0pt]
\>Adj\ =\ NEW\symbol{95}INT(sz\ *\ sz);\\[0pt]
\>INT\symbol{95}vec\symbol{95}zero(Adj\symbol{44}\ sz\ *\ sz);\\[0pt]
\\[0pt]
\>for\ (i\ =\ 0;\ i\ <\ sz;\ i++)\ \symbol{123}\\[0pt]
\>\>Gr\symbol{45}>unrank\symbol{95}INT\symbol{95}here(M1\symbol{44}\ List[i]\symbol{44}\ 0\ /*\ verbose\symbol{95}level\ */);\\[0pt]
\\[0pt]
\>\>for\ (j\ =\ i\ +\ 1;\ j\ <\ sz;\ j++)\ \symbol{123}\\[0pt]
\>\>\>Gr\symbol{45}>unrank\symbol{95}INT\symbol{95}here(M2\symbol{44}\ List[j]\symbol{44}\ 0\ /*\ verbose\symbol{95}level\ */);\\[0pt]
\\[0pt]
\>\>\>INT\symbol{95}vec\symbol{95}copy(M1\symbol{44}\ M\symbol{44}\ k\ *\ n);\\[0pt]
\>\>\>INT\symbol{95}vec\symbol{95}copy(M2\symbol{44}\ M\ +\ k\ *\ n\symbol{44}\ k\ *\ n);\\[0pt]
\\[0pt]
\>\>\>rr\ =\ F\symbol{45}>rank\symbol{95}of\symbol{95}rectangular\symbol{95}matrix(M\symbol{44}\ 2\ *\ k\symbol{44}\ n\symbol{44}\ 0\ /*\ verbose\symbol{95}level\ */);\\[0pt]
\>\>\>if\ (rr\ ==\ 2\ *\ k)\ \symbol{123}\\[0pt]
\>\>\>\>Adj[i\ *\ sz\ +\ j]\ =\ 1;\\[0pt]
\>\>\>\>Adj[j\ *\ sz\ +\ i]\ =\ 1;\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\>colored\symbol{95}graph\ *CG;\\[0pt]
\>BYTE\ fname[1000];\\[0pt]
\\[0pt]
\>CG\ =\ new\ colored\symbol{95}graph;\\[0pt]
\>CG\symbol{45}>init\symbol{95}adjacency\symbol{95}no\symbol{95}colors(sz\symbol{44}\ Adj\symbol{44}\ verbose\symbol{95}level);\\[0pt]
\\[0pt]
\>sprintf(fname\symbol{44}\ \symbol{34}Schlaefli\symbol{95}\symbol{37}ld\symbol{46}colored\symbol{95}graph\symbol{34}\symbol{44}\ q);\\[0pt]
\\[0pt]
\>CG\symbol{45}>save(fname\symbol{44}\ verbose\symbol{95}level);\\[0pt]
\\[0pt]
\>delete\ CG;\\[0pt]
\>FREE\symbol{95}INT(List);\\[0pt]
\>FREE\symbol{95}INT(Adj);\\[0pt]
\>FREE\symbol{95}INT(M1);\\[0pt]
\>FREE\symbol{95}INT(M2);\\[0pt]
\>FREE\symbol{95}INT(M);\\[0pt]
\>delete\ Gr;\\[0pt]
\>delete\ F;\\[0pt]
\symbol{125}\\[0pt]
\\[0pt]
INT\ evaluate\symbol{95}cubic\symbol{95}form(finite\symbol{95}field\ *F\symbol{44}\ INT\ *v)\\[0pt]
\symbol{123}\\[0pt]
\>INT\ a\symbol{44}\ i;\\[0pt]
\\[0pt]
\>a\ =\ 0;\\[0pt]
\>for\ (i\ =\ 0;\ i\ <\ 4;\ i++)\ \symbol{123}\\[0pt]
\>\>a\ =\ F\symbol{45}>add(a\symbol{44}\ F\symbol{45}>power(v[i]\symbol{44}\ 3));\\[0pt]
\>\>\symbol{125}\\[0pt]
\>return\ a;\\[0pt]
\symbol{125}\\[0pt]
\\[0pt]
\end{tabbing}
