%
% created by a2tex
%
\begin{tabbing}
55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= 55 \= \kill
//\ determine\symbol{95}conic\symbol{46}C\\[0pt]
//\ \\[0pt]
//\ Anton\ Betten\\[0pt]
//\ Nov\ 16\symbol{44}\ 2010\\[0pt]
//\\[0pt]
//\ based\ on\ COMBINATORICS/conic\symbol{46}C\\[0pt]
//\\[0pt]
//\ computes\ the\ equation\ of\ a\ conic\ through\ 5\ given\ points\\[0pt]
//\ in\ PG(2\symbol{44}\ q)\\[0pt]
//\ usage:\\[0pt]
//\ \symbol{45}q\ <q>\ \symbol{45}pts\ <p1>\ <p2>\ <p3>\ <p4>\ <p5>\\[0pt]
//\ OR\\[0pt]
//\ \symbol{45}q\ <q>\ \symbol{45}pt\symbol{95}coords\ <x1>\ <y1>\ <z1>\ <x2>\ <y2>\ <z2>\ \symbol{46}\symbol{46}\symbol{46}\ <x4>\ <y5>\ <z5>\ \symbol{45}1\\[0pt]
\\[0pt]
\\[0pt]
\\[0pt]
\symbol{35}include\ \symbol{34}orbiter\symbol{46}h\symbol{34}\\[0pt]
\\[0pt]
\\[0pt]
INT\ determine\symbol{95}conic(finite\symbol{95}field\ *F\symbol{44}\ INT\ *input\symbol{95}pts\symbol{44}\ INT\ nb\symbol{95}pts\symbol{44}\ INT\ *six\symbol{95}coeffs\symbol{44}\ INT\ verbose\symbol{95}level);\\[0pt]
//\ returns\ FALSE\ is\ the\ rank\ of\ the\ coefficient\ matrix\ is\ not\ 5\symbol{46}\ TRUE\ otherwise\symbol{46}\\[0pt]
\\[0pt]
\\[0pt]
int\ main(int\ argc\symbol{44}\ char\ **argv)\\[0pt]
\symbol{123}\\[0pt]
\>INT\ verbose\symbol{95}level\ =\ 1;\\[0pt]
\>INT\ i;\\[0pt]
\>INT\ q\ =\ \symbol{45}1;\\[0pt]
\>INT\ nb\symbol{95}pts\ =\ 0;\\[0pt]
\>INT\ pts[1000];\\[0pt]
\>INT\ nb\symbol{95}pt\symbol{95}coords\ =\ 0;\\[0pt]
\>INT\ pt\symbol{95}coords[1000];\\[0pt]
\>INT\ f\symbol{95}poly\ =\ FALSE;\\[0pt]
\>const\ BYTE\ *override\symbol{95}poly\ =\ NULL;\\[0pt]
\>\\[0pt]
\>for\ (i\ =\ 1;\ i\ <\ argc;\ i++)\ \symbol{123}\\[0pt]
\>\>if\ (strcmp(argv[i]\symbol{44}\ \symbol{34}\symbol{45}v\symbol{34})\ ==\ 0)\ \symbol{123}\\[0pt]
\>\>\>verbose\symbol{95}level\ =\ atoi(argv[++i]);\\[0pt]
\>\>\>cout\ <<\ \symbol{34}\symbol{45}v\ \symbol{34}\ <<\ verbose\symbol{95}level\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>else\ if\ (strcmp(argv[i]\symbol{44}\ \symbol{34}\symbol{45}q\symbol{34})\ ==\ 0)\ \symbol{123}\\[0pt]
\>\>\>q\ =\ atoi(argv[++i]);\\[0pt]
\>\>\>cout\ <<\ \symbol{34}\symbol{45}q\ \symbol{34}\ <<\ q\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>else\ if\ (strcmp(argv[i]\symbol{44}\ \symbol{34}\symbol{45}poly\symbol{34})\ ==\ 0)\ \symbol{123}\\[0pt]
\>\>\>f\symbol{95}poly\ =\ TRUE;\\[0pt]
\>\>\>override\symbol{95}poly\ =\ argv[++i];\\[0pt]
\>\>\>cout\ <<\ \symbol{34}\symbol{45}poly\ \symbol{34}\ <<\ override\symbol{95}poly\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>else\ if\ (strcmp(argv[i]\symbol{44}\ \symbol{34}\symbol{45}pts\symbol{34})\ ==\ 0)\ \symbol{123}\\[0pt]
\>\>\>while\ (TRUE)\ \symbol{123}\\[0pt]
\>\>\>\>pts[nb\symbol{95}pts]\ =\ atoi(argv[++i]);\\[0pt]
\>\>\>\>if\ (pts[nb\symbol{95}pts]\ ==\ \symbol{45}1)\ \symbol{123}\\[0pt]
\>\>\>\>\>break;\\[0pt]
\>\>\>\>\>\symbol{125}\\[0pt]
\>\>\>\>nb\symbol{95}pts++;\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>cout\ <<\ \symbol{34}\symbol{45}pts\ \symbol{34};\\[0pt]
\>\>\>INT\symbol{95}vec\symbol{95}print(cout\symbol{44}\ pts\symbol{44}\ nb\symbol{95}pts);\\[0pt]
\>\>\>cout\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>else\ if\ (strcmp(argv[i]\symbol{44}\ \symbol{34}\symbol{45}pt\symbol{95}coords\symbol{34})\ ==\ 0)\ \symbol{123}\\[0pt]
\>\>\>while\ (TRUE)\ \symbol{123}\\[0pt]
\>\>\>\>pt\symbol{95}coords[nb\symbol{95}pt\symbol{95}coords]\ =\ atoi(argv[++i]);\\[0pt]
\>\>\>\>if\ (pt\symbol{95}coords[nb\symbol{95}pt\symbol{95}coords]\ ==\ \symbol{45}1)\ \symbol{123}\\[0pt]
\>\>\>\>\>break;\\[0pt]
\>\>\>\>\>\symbol{125}\\[0pt]
\>\>\>\>nb\symbol{95}pt\symbol{95}coords++;\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>cout\ <<\ \symbol{34}\symbol{45}pt\symbol{95}coords\ \symbol{34};\\[0pt]
\>\>\>INT\symbol{95}vec\symbol{95}print(cout\symbol{44}\ pt\symbol{95}coords\symbol{44}\ nb\symbol{95}pt\symbol{95}coords);\\[0pt]
\>\>\>cout\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\>INT\ f\symbol{95}v\ =\ (verbose\symbol{95}level\ >=\ 1);\\[0pt]
\>INT\ *input\symbol{95}pts;\\[0pt]
\>INT\ six\symbol{95}coeffs[6];\\[0pt]
\>finite\symbol{95}field\ *F;\\[0pt]
\\[0pt]
\>if\ (q\ ==\ \symbol{45}1)\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}please\ use\ option\ \symbol{45}q\ <q>\symbol{34}\ <<\ endl;\\[0pt]
\>\>exit(1);\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\>F\ =\ new\ finite\symbol{95}field;\\[0pt]
\\[0pt]
\>F\symbol{45}>init(q\symbol{44}\ 0);\\[0pt]
\>F\symbol{45}>init\symbol{95}override\symbol{95}polynomial(q\symbol{44}\ override\symbol{95}poly\symbol{44}\ verbose\symbol{95}level);\\[0pt]
\\[0pt]
\>if\ (nb\symbol{95}pts)\ \symbol{123}\\[0pt]
\>\>if\ (nb\symbol{95}pts\ <\ 5)\ \symbol{123}\\[0pt]
\>\>\>cout\ <<\ \symbol{34}please\ give\ exactly\ 5\ points\ using\ \symbol{45}pts\ <p1>\ \symbol{46}\symbol{46}\symbol{46}\ <p5>\symbol{34}\ <<\ endl;\\[0pt]
\>\>\>exit(1);\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>input\symbol{95}pts\ =\ NEW\symbol{95}INT(nb\symbol{95}pts);\\[0pt]
\>\>INT\symbol{95}vec\symbol{95}copy(pts\symbol{44}\ input\symbol{95}pts\symbol{44}\ nb\symbol{95}pts);\\[0pt]
\>\>\symbol{125}\\[0pt]
\>else\ if\ (nb\symbol{95}pt\symbol{95}coords)\ \symbol{123}\\[0pt]
\>\>INT\ a;\\[0pt]
\>\>\\[0pt]
\>\>nb\symbol{95}pts\ =\ nb\symbol{95}pt\symbol{95}coords\ /\ 3;\\[0pt]
\>\>if\ (nb\symbol{95}pt\symbol{95}coords\ <\ 15)\ \symbol{123}\\[0pt]
\>\>\>cout\ <<\ \symbol{34}please\ give\ at\ least\ 15\ point\ coordinates\ using\ \symbol{45}pt\symbol{95}coords\ <p1>\ \symbol{46}\symbol{46}\symbol{46}\ <p15>\symbol{34}\ <<\ endl;\\[0pt]
\>\>\>exit(1);\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>input\symbol{95}pts\ =\ NEW\symbol{95}INT(nb\symbol{95}pts);\\[0pt]
\>\>for\ (i\ =\ 0;\ i\ <\ nb\symbol{95}pts;\ i++)\ \symbol{123}\\[0pt]
\>\>\>cout\ <<\ \symbol{34}point\ \symbol{34}\ <<\ i\ <<\ \symbol{34}\ has\ coordinates\ \symbol{34};\\[0pt]
\>\>\>INT\symbol{95}vec\symbol{95}print(cout\symbol{44}\ pt\symbol{95}coords\ +\ i\ *\ 3\symbol{44}\ 3);\\[0pt]
\>\>\>cout\ <<\ endl;\\[0pt]
\>\>\>a\ =\ F\symbol{45}>rank\symbol{95}point\symbol{95}in\symbol{95}PG(pt\symbol{95}coords\ +\ i\ *\ 3\symbol{44}\ 3);\\[0pt]
\>\>\>input\symbol{95}pts[i]\ =\ a;\\[0pt]
\>\>\>cout\ <<\ \symbol{34}and\ rank\ \symbol{34}\ <<\ a\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>\symbol{125}\\[0pt]
\>else\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}Please\ specify\ points\ using\ \symbol{45}pts\ or\ using\ \symbol{45}pt\symbol{95}coordinates\symbol{34}\ <<\ endl;\\[0pt]
\>\>exit(1);\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\\[0pt]
\\[0pt]
\>cout\ <<\ \symbol{34}input\symbol{95}pts:\ \symbol{34};\\[0pt]
\>INT\symbol{95}vec\symbol{95}print(cout\symbol{44}\ input\symbol{95}pts\symbol{44}\ nb\symbol{95}pts);\\[0pt]
\>cout\ <<\ endl;\\[0pt]
\\[0pt]
\>determine\symbol{95}conic(F\symbol{44}\ input\symbol{95}pts\symbol{44}\ nb\symbol{95}pts\symbol{44}\ six\symbol{95}coeffs\symbol{44}\ verbose\symbol{95}level);\\[0pt]
\\[0pt]
\>if\ (f\symbol{95}v)\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}determine\symbol{95}conic\ the\ conic\ is\ \symbol{34};\\[0pt]
\>\>INT\ f\symbol{95}first\ =\ TRUE;\\[0pt]
\>\>if\ (six\symbol{95}coeffs[0])\ \symbol{123}\\[0pt]
\>\>\>cout\ <<\ six\symbol{95}coeffs[0]\ <<\ \symbol{34}*X\symbol{94}2\symbol{34};\\[0pt]
\>\>\>f\symbol{95}first\ =\ FALSE;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>if\ (six\symbol{95}coeffs[1])\ \symbol{123}\\[0pt]
\>\>\>if\ (\symbol{33}f\symbol{95}first)\ \symbol{123}\\[0pt]
\>\>\>\>cout\ <<\ \symbol{34}\ +\ \symbol{34};\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>cout\ <<\ six\symbol{95}coeffs[1]\ <<\ \symbol{34}*Y\symbol{94}2\symbol{34};\\[0pt]
\>\>\>f\symbol{95}first\ =\ FALSE;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>if\ (six\symbol{95}coeffs[2])\ \symbol{123}\\[0pt]
\>\>\>if\ (\symbol{33}f\symbol{95}first)\ \symbol{123}\\[0pt]
\>\>\>\>cout\ <<\ \symbol{34}\ +\ \symbol{34};\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>cout\ <<\ six\symbol{95}coeffs[2]\ <<\ \symbol{34}*Z\symbol{94}2\symbol{34};\\[0pt]
\>\>\>f\symbol{95}first\ =\ FALSE;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>if\ (six\symbol{95}coeffs[3])\ \symbol{123}\\[0pt]
\>\>\>if\ (\symbol{33}f\symbol{95}first)\ \symbol{123}\\[0pt]
\>\>\>\>cout\ <<\ \symbol{34}\ +\ \symbol{34};\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>cout\ <<\ six\symbol{95}coeffs[3]\ <<\ \symbol{34}*XY\symbol{34};\\[0pt]
\>\>\>f\symbol{95}first\ =\ FALSE;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>if\ (six\symbol{95}coeffs[4])\ \symbol{123}\\[0pt]
\>\>\>if\ (\symbol{33}f\symbol{95}first)\ \symbol{123}\\[0pt]
\>\>\>\>cout\ <<\ \symbol{34}\ +\ \symbol{34};\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>cout\ <<\ six\symbol{95}coeffs[4]\ <<\ \symbol{34}*XZ\symbol{34};\\[0pt]
\>\>\>f\symbol{95}first\ =\ FALSE;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>if\ (six\symbol{95}coeffs[5])\ \symbol{123}\\[0pt]
\>\>\>if\ (\symbol{33}f\symbol{95}first)\ \symbol{123}\\[0pt]
\>\>\>\>cout\ <<\ \symbol{34}\ +\ \symbol{34};\\[0pt]
\>\>\>\>\symbol{125}\\[0pt]
\>\>\>cout\ <<\ six\symbol{95}coeffs[5]\ <<\ \symbol{34}*YZ\symbol{34};\\[0pt]
\>\>\>f\symbol{95}first\ =\ FALSE;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>cout\ <<\ endl;\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\>delete\ F;\\[0pt]
\>FREE\symbol{95}INT(input\symbol{95}pts);\\[0pt]
\\[0pt]
\symbol{125}\\[0pt]
\\[0pt]
INT\ determine\symbol{95}conic(finite\symbol{95}field\ *F\symbol{44}\ INT\ *input\symbol{95}pts\symbol{44}\ INT\ nb\symbol{95}pts\symbol{44}\ INT\ *six\symbol{95}coeffs\symbol{44}\ INT\ verbose\symbol{95}level)\\[0pt]
//\ returns\ FALSE\ is\ the\ rank\ of\ the\ coefficient\ matrix\ is\ not\ 5\symbol{46}\ TRUE\ otherwise\symbol{46}\\[0pt]
\symbol{123}\\[0pt]
\>INT\ f\symbol{95}v\ =\ (verbose\symbol{95}level\ >=\ 1);\\[0pt]
\>INT\ f\symbol{95}vv\ =\ (verbose\symbol{95}level\ >=\ 2);\\[0pt]
\>INT\ *coords;\ //\ [nb\symbol{95}pts\ *\ 3];\\[0pt]
\>INT\ *system;\ //\ [nb\symbol{95}pts\ *\ 6];\\[0pt]
\>INT\ kernel[6\ *\ 6];\\[0pt]
\>INT\ base\symbol{95}cols[6];\\[0pt]
\>INT\ i\symbol{44}\ x\symbol{44}\ y\symbol{44}\ z\symbol{44}\ rk;\\[0pt]
\>INT\ kernel\symbol{95}m\symbol{44}\ kernel\symbol{95}n;\\[0pt]
\\[0pt]
\>if\ (f\symbol{95}v)\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}determine\symbol{95}conic\symbol{34}\ <<\ endl;\\[0pt]
\>\>\symbol{125}\\[0pt]
\>if\ (nb\symbol{95}pts\ <\ 5)\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}determine\symbol{95}conic\ need\ at\ least\ 5\ points\symbol{34}\ <<\ endl;\\[0pt]
\>\>exit(1);\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\\[0pt]
\>coords\ =\ NEW\symbol{95}INT(nb\symbol{95}pts\ *\ 3);\\[0pt]
\>system\ =\ NEW\symbol{95}INT(nb\symbol{95}pts\ *\ 6);\\[0pt]
\>for\ (i\ =\ 0;\ i\ <\ nb\symbol{95}pts;\ i++)\ \symbol{123}\\[0pt]
\>\>F\symbol{45}>unrank\symbol{95}point\symbol{95}in\symbol{95}PG(coords\ +\ i\ *\ 3\symbol{44}\ 3\symbol{44}\ input\symbol{95}pts[i]);\\[0pt]
\>\>\symbol{125}\\[0pt]
\>if\ (f\symbol{95}vv)\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}determine\symbol{95}conic\ points:\symbol{34}\ <<\ endl;\\[0pt]
\>\>print\symbol{95}integer\symbol{95}matrix\symbol{95}width(cout\symbol{44}\ coords\symbol{44}\ nb\symbol{95}pts\symbol{44}\ 3\symbol{44}\ 3\symbol{44}\ F\symbol{45}>log10\symbol{95}of\symbol{95}q);\\[0pt]
\>\>\symbol{125}\\[0pt]
\>for\ (i\ =\ 0;\ i\ <\ nb\symbol{95}pts;\ i++)\ \symbol{123}\\[0pt]
\>\>x\ =\ coords[i\ *\ 3\ +\ 0];\\[0pt]
\>\>y\ =\ coords[i\ *\ 3\ +\ 1];\\[0pt]
\>\>z\ =\ coords[i\ *\ 3\ +\ 2];\\[0pt]
\>\>system[i\ *\ 6\ +\ 0]\ =\ F\symbol{45}>mult(x\symbol{44}\ x);\\[0pt]
\>\>system[i\ *\ 6\ +\ 1]\ =\ F\symbol{45}>mult(y\symbol{44}\ y);\\[0pt]
\>\>system[i\ *\ 6\ +\ 2]\ =\ F\symbol{45}>mult(z\symbol{44}\ z);\\[0pt]
\>\>system[i\ *\ 6\ +\ 3]\ =\ F\symbol{45}>mult(x\symbol{44}\ y);\\[0pt]
\>\>system[i\ *\ 6\ +\ 4]\ =\ F\symbol{45}>mult(x\symbol{44}\ z);\\[0pt]
\>\>system[i\ *\ 6\ +\ 5]\ =\ F\symbol{45}>mult(y\symbol{44}\ z);\\[0pt]
\>\>\symbol{125}\\[0pt]
\>if\ (f\symbol{95}v)\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}determine\symbol{95}conic\ system:\symbol{34}\ <<\ endl;\\[0pt]
\>\>print\symbol{95}integer\symbol{95}matrix\symbol{95}width(cout\symbol{44}\ system\symbol{44}\ nb\symbol{95}pts\symbol{44}\ 6\symbol{44}\ 6\symbol{44}\ F\symbol{45}>log10\symbol{95}of\symbol{95}q);\\[0pt]
\>\>\symbol{125}\\[0pt]
\\[0pt]
\\[0pt]
\\[0pt]
\>rk\ =\ F\symbol{45}>Gauss\symbol{95}simple(system\symbol{44}\ nb\symbol{95}pts\symbol{44}\ 6\symbol{44}\ base\symbol{95}cols\symbol{44}\ verbose\symbol{95}level\ \symbol{45}\ 2);\\[0pt]
\>if\ (rk\ \symbol{33}=\ 5)\ \symbol{123}\\[0pt]
\>\>if\ (f\symbol{95}v)\ \symbol{123}\\[0pt]
\>\>\>cout\ <<\ \symbol{34}determine\symbol{95}conic\ system\ underdetermined\symbol{34}\ <<\ endl;\\[0pt]
\>\>\>\symbol{125}\\[0pt]
\>\>return\ FALSE;\\[0pt]
\>\>\symbol{125}\\[0pt]
\>F\symbol{45}>matrix\symbol{95}get\symbol{95}kernel(system\symbol{44}\ 5\symbol{44}\ 6\symbol{44}\ base\symbol{95}cols\symbol{44}\ rk\symbol{44}\ \\[0pt]
\>\>kernel\symbol{95}m\symbol{44}\ kernel\symbol{95}n\symbol{44}\ kernel);\\[0pt]
\>if\ (f\symbol{95}v)\ \symbol{123}\\[0pt]
\>\>cout\ <<\ \symbol{34}determine\symbol{95}conic\ conic:\symbol{34}\ <<\ endl;\\[0pt]
\>\>print\symbol{95}integer\symbol{95}matrix\symbol{95}width(cout\symbol{44}\ kernel\symbol{44}\ 1\symbol{44}\ 6\symbol{44}\ 6\symbol{44}\ F\symbol{45}>log10\symbol{95}of\symbol{95}q);\\[0pt]
\>\>\symbol{125}\\[0pt]
\>for\ (i\ =\ 0;\ i\ <\ 6;\ i++)\ \symbol{123}\\[0pt]
\>\>six\symbol{95}coeffs[i]\ =\ kernel[i];\\[0pt]
\>\>\symbol{125}\\[0pt]
\>FREE\symbol{95}INT(coords);\\[0pt]
\>FREE\symbol{95}INT(system);\\[0pt]
\>return\ TRUE;\\[0pt]
\symbol{125}\\[0pt]
\\[0pt]
\\[0pt]
\end{tabbing}
